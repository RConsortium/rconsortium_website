<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Manon Simonot, Aymeric Stamm">
<meta name="dcterms.date" content="2026-01-28">
<meta name="description" content="{inphr} supports statistical inference for samples of persistence diagrams from persistent homology. It focuses on comparing populations of diagrams across different data types.">

<title>R Consortium - Statistical Inference for Persistence Diagrams</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/rc-favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B697SX1BNN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-B697SX1BNN', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/RConsortium_Horizontal_Pantone.webp" alt="R Consortium logo" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../about/index.html" rel="" target="">
 <span class="dropdown-text">Mission</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/governance.html" rel="" target="">
 <span class="dropdown-text">Governance</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../rc-docs/R-Consortium-Bylaws-7-9-2024.pdf" rel="" target="">
 <span class="dropdown-text">Bylaws (PDF)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../governance/isc-charter.html" rel="" target="">
 <span class="dropdown-text">ISC Charter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../rc-docs/R-Consortium-Marketing-Committee-Charter-2021-10-27.pdf" rel="" target="">
 <span class="dropdown-text">Marketing Committee Charter (PDF)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/faq.html" rel="" target="">
 <span class="dropdown-text">FAQ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/contact.html" rel="" target="">
 <span class="dropdown-text">Contact</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/privacy.html" rel="" target="">
 <span class="dropdown-text">Privacy Policy</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-members" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Members</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-members">    
        <li>
    <a class="dropdown-item" href="../../members.html" rel="" target="">
 <span class="dropdown-text">Members</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/join.html" rel="" target="">
 <span class="dropdown-text">Join</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../rc-docs/R-Consortium-Membership-Agreement-1157181-v2-Approved-11.20.19.pdf" rel="" target="">
 <span class="dropdown-text">Membership Agreement (PDF)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-grants" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Grants</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-grants">    
        <li>
    <a class="dropdown-item" href="../../all-projects/index.html" rel="" target="">
 <span class="dropdown-text">Goal of ISC Grants Program</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../all-projects/funded-projects.html" rel="" target="">
 <span class="dropdown-text">Recipients of ISC Grants</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../all-projects/callforproposals.html" rel="" target="">
 <span class="dropdown-text">Call for Proposals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../all-projects/rugsprogram.html" rel="" target="">
 <span class="dropdown-text">RUGS Program</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../all-projects/submittingforpayment.html" rel="" target="">
 <span class="dropdown-text">Submitting for payment</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="https://rladies.org/" rel="" target="">
 <span class="dropdown-text">R-Ladies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://r-dbi.org/" rel="" target="">
 <span class="dropdown-text">DBI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://r-universe.dev/search" rel="" target="">
 <span class="dropdown-text">R-Universe</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../all-projects/isc-working-groups.html" rel="" target="">
 <span class="dropdown-text">Working Groups</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../all-projects/previous-top-level-projects.html" rel="" target="">
 <span class="dropdown-text">Previous Top-Level Projects</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-events" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Events</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-events">    
        <li>
    <a class="dropdown-item" href="https://rconsortium.github.io/Risk_website/" rel="" target="">
 <span class="dropdown-text">R!sk (Feb 18-19, 2026)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rconsortium.github.io/RMedicine_website/" rel="" target="">
 <span class="dropdown-text">R/Medicine (May 4-8, 2026)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webinars/webinars.html" rel="" target="">
 <span class="dropdown-text">Webinars</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../news/events.html" rel="" target="">
 <span class="dropdown-text">Events</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../news/cal.html" rel="" target="">
 <span class="dropdown-text">Working Groups Calendar</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-news" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">News</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-news">    
        <li>
    <a class="dropdown-item" href="../../blog/index.html" rel="" target="">
 <span class="dropdown-text">Blog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../newsletters/newsletters.html" rel="" target="">
 <span class="dropdown-text">Newsletter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../rc-docs/RC-AR-2023_Final-Draft_1-30-24.pdf" rel="" target="">
 <span class="dropdown-text">Annual Report 2023 (PDF)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../rc-docs/R-Consortium-5-year-retrospective-2021-10-28.pdf" rel="" target="">
 <span class="dropdown-text">Annual Report 2021 (PDF)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../codeofconduct.html" rel="" target="">
 <span class="menu-text">Code of Conduct</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rconsortium" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/company/r-consortium/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/(RConsortium?)" rel="" target=""><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/rconsortium.bsky.social" rel="" target=""><i class="bi bi-cloud" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/(RConsortium?)" rel="" target=""><i class="bi bi-youtube" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/RConsortium" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Statistical Inference for Persistence Diagrams</h1>
                  <div>
        <div class="description">
          {inphr} supports statistical inference for samples of persistence diagrams from persistent homology. It focuses on comparing populations of diagrams across different data types.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">isc</div>
                <div class="quarto-category">software development</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Manon Simonot, Aymeric Stamm </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 28, 2026</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="samples-of-persistence-diagrams" class="level2">
<h2 class="anchored" data-anchor-id="samples-of-persistence-diagrams">Samples of persistence diagrams</h2>
<p>Topological data analysis (TDA) is a rapidly growing field that uses techniques from algebraic topology to analyze the shape and structure of data. At its core, TDA provides tools to understand the geometric and topological features of datasets across multiple scales, with persistent homology (PH) being one of its fundamental techniques.</p>
<p>The documentation of the <a href="https://tdaverse.github.io/phutil/">{phutil}</a> package provides an <a href="https://tdaverse.github.io/phutil/articles/validation-benchmark.html#definitions">overview of persistent homology</a>. For now, know that the result of this procedure is a <strong>persistence diagram</strong>: a multiset (set with multiplicity) of points in the plane—usually the upper-half plane and most often the first quadrant. Persistence diagrams encode topological features of different dimensions, and a single diagram may encode features of one or all dimensions. By <strong>persistence data</strong>, we mean a data structure that encodes diagrams of all dimensions, and possibly many diagrams coming from data sets of a common type.</p>
<p>The goal of <a href="https://tdaverse.github.io/inphr/">{inphr}</a> is precisely to deal with comparing populations of persistence diagrams coming from data sets of different types. This is classically called the task of making inference on the basis of some collected data. Several R packages include inferential capabilities for persistence diagrams, including:</p>
<ul>
<li><a href="https://cran.r-project.org/package=TDA">{TDA}</a> which focuses on statistical analysis of PH and density clustering by providing an R interface for the efficient algorithms of the C++ libraries <a href="https://project.inria.fr/gudhi/software/">GUDHI</a>, <a href="https://www.mrzv.org/software/dionysus/">Dionysus</a> and <a href="https://bitbucket.org/phat-code/phat/">PHAT</a>. This package also implements methods from <span class="citation" data-cites="fasy2014confidence">Fasy et al. (<a href="#ref-fasy2014confidence" role="doc-biblioref">2014</a>)</span> and <span class="citation" data-cites="chazal2014stochastic">Chazal et al. (<a href="#ref-chazal2014stochastic" role="doc-biblioref">2014</a>)</span> for analyzing the statistical significance of PH features.</li>
<li><a href="https://cran.r-project.org/package=TDAstats">{TDAstats}</a> which provides a comprehensive toolset for conducting TDA, specifically via the calculation of PH in a Vietoris-Rips complex <span class="citation" data-cites="wadhwa2018tdastats">(<a href="#ref-wadhwa2018tdastats" role="doc-biblioref">Wadhwa et al. 2018</a>)</span>.</li>
<li><a href="https://cran.r-project.org/package=TDAkit">{TDAkit}</a> which provides a variety of algorithms to learn with PH of the data based on functional summaries for clustering, hypothesis testing, and visualization <span class="citation" data-cites="wasserman2018topological">(<a href="#ref-wasserman2018topological" role="doc-biblioref">Wasserman 2018</a>)</span>.</li>
</ul>
<p>While these packages have made inference on persistence diagrams available to the R community, they only deal with inference on a single diagram using bootstrap resampling ({TDA}), or only offer inference to compare two diagrams by permutations ({TDAstats}), or only compare functional summaries of groups of persistence diagrams to answer whether they come from the same underlying distribution ({TDAkit}).</p>
<p>The {inphr} package aims at going one step further by offering two sets of functions for making inference:</p>
<ol type="1">
<li>in the space of persistence diagrams (<a href="#sec-pd">Section&nbsp;2</a>) for testing whether multiple collections of persistence diagrams come from the same underlying distribution;</li>
<li>in functional spaces (<a href="#sec-functions">Section&nbsp;3</a>) for localizing differences between multiple collections of persistence diagrams on the domain of some functional summary of them.</li>
</ol>
<p>The following sections showcase these two kinds of inference.</p>
</section>
<section id="sec-pd" class="level2">
<h2 class="anchored" data-anchor-id="sec-pd">Inference in the space of persistence diagrams</h2>
<section id="distances-between-persistence-diagrams" class="level3">
<h3 class="anchored" data-anchor-id="distances-between-persistence-diagrams">Distances between persistence diagrams</h3>
<p>Two persistence diagrams <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are canonically compared using <strong>Wasserstein distances</strong>. These are a family of metrics determined by a <span class="math inline">\(q\)</span>-Minkowski distance on the plane and a <span class="math inline">\(p\)</span>-norm on the distances between pairs of points matched via some <span class="math inline">\(\varphi : X \to Y\)</span>:</p>
<p><span class="math display">\[ \left( \sum_{x \in X}{{\lVert
x-\varphi(x) \rVert_q}^p} \right)^{1/p} \]</span></p>
<p>The distance <span class="math inline">\(W_p^q(X,Y)\)</span> is defined to be the infimum of this expression over all possible matchings. See this <a href="https://tdaverse.github.io/phutil/articles/validation-benchmark.html">vignette</a> from the {phutil} package on distances for more detail, or <span class="citation" data-cites="cohen2010lipschitz">Cohen-Steiner et al. (<a href="#ref-cohen2010lipschitz" role="doc-biblioref">2010</a>)</span> and <span class="citation" data-cites="bubenik2023exact">Bubenik, Scott, and Stanley (<a href="#ref-bubenik2023exact" role="doc-biblioref">2023</a>)</span> for detailed treatments and stability results on these families of metrics.</p>
<p>In R, using the TDAverse, computation of the distance matrix is offered by the {phutil} package which is therefore a hard dependency of {inphr}.</p>
<p>Functions in {inphr} therefore accept:</p>
<ul>
<li>either two objects of class ‘persistence_set’ produced by <code>phutil::as_persistence_set()</code> representing the two samples;</li>
<li>or an object of class ‘persistence_set’ produced by <code>phutil::as_persistence_set()</code> representing the contatenation of the two samples and a vector of two integers providing the sample sizes;</li>
<li>or an object of class ‘dist’ typically produced by <code>phutil::bottleneck_pairwise_distances()</code> or <code>phutil::wasserstein_pairwise_distances()</code> and a vector of two integers with the sample sizes.</li>
</ul>
</section>
<section id="permutation-inference" class="level3">
<h3 class="anchored" data-anchor-id="permutation-inference">Permutation inference</h3>
<p>The package currently includes a function to compare two samples of persistence diagrams. The statistical method for doing that is described in <span class="citation" data-cites="lovato2021multiscale">Lovato et al. (<a href="#ref-lovato2021multiscale" role="doc-biblioref">2021</a>)</span>. Subtantively, it performs inference in two steps:</p>
<ol type="1">
<li>Pre-computation of the matrix <span class="math inline">\(D\)</span> of pairwise distances between persistence diagrams within and between samples;</li>
<li>Permutations of the rows and columns of <span class="math inline">\(D\)</span> to approximate the distribution of one or more test statistics.</li>
</ol>
<p>Let <span class="math inline">\(F_1\)</span> be the probability distribution that generated the first sample and <span class="math inline">\(F_2\)</span> be the probability distribution that generated the second sample. Inference by permutations helps answering the following hypothesis test:</p>
<p><span class="math display">\[
H_0 : F_1 = F_2 \quad \mbox{v.s.} \quad H_a : F_1 \ne F_2.
\]</span></p>
<p>Differently from classic parametric inference in which the null hypothesis typically assumes equality of the mean parameters or the variance parameters, it is critical that the null distribution be that the entire probability distributions be the same. This is essential because only then can we permute the labels of statistical units under the null hypothesis.</p>
<p>However, depending on the test statistic that is used, the test only focuses on comparing some features of the probability distributions. For instance, if one uses the distance between the Frechet means as test statistic, the test will detect differences in means between the two ditributions but will be blind to differences in variances for example. For this reason, one can use multiple test statistics to make the test sensitive to differences in several moments of the distributions. This is called <em>non-parametric combination</em> and it is described in <span class="citation" data-cites="pesarin2010permutation">Pesarin and Salmaso (<a href="#ref-pesarin2010permutation" role="doc-biblioref">2010</a>)</span>.</p>
<p>The {inphr} package uses this approach by relying on the <a href="https://permaverse.github.io/flipr/">{flipr}</a> package which is the core package of the <a href="https://github.com/permaverse">permaverse</a> collection of packages for permutation inference. Specifically, the dedicated function is <code>two_sample_diagram_test()</code> and, by default, it combines two test statistics based solely on inter-point distances that are defined in <span class="citation" data-cites="lovato2021multiscale">Lovato et al. (<a href="#ref-lovato2021multiscale" role="doc-biblioref">2021</a>)</span>. One is sensitive to differences in means and the other to differences in variances. The user can actually choose one or more test statistics or even define his/her own. The result of the test is a p-value that helps in making the decision of whether to reject the null hypothesis. Optionally, one can ask the function to return the permutations that have been used (<code>keep_permutations = TRUE</code>) and the permutation distribution of the combined test statistic (<code>keep_null_distribution = TRUE</code>).</p>
</section>
<section id="toy-examples" class="level3">
<h3 class="anchored" data-anchor-id="toy-examples">Toy examples</h3>
<p>The {inphr} package includes the following three toy data sets.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>trefoils1</code> and <code>trefoils2</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Two sets of 24 persistence diagrams each computed from noisy samples of trefoil knots. Each sample consists of 120 points sampled from a trefoil knot with Gaussian noise (sd = 0.05) added. Vietoris-Rips persistence was computed up to dimension 2 with maximum scale 6 using <code>TDA::ripsDiag()</code>. Generated with seed 28415.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>archspirals</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>A set of 24 persistence diagrams computed from noisy samples of 2-armed Archimedean spirals. Each sample consists of 120 points sampled from an Archimedean spiral, embedded in 3D with a zero z-coordinate, then Gaussian noise (sd = 0.05) added. Vietoris-Rips persistence was computed up to dimension 2 with maximum scale 6 using <code>TDA::ripsDiag()</code>. Generated with seed 28415.</p>
</div>
</div>
<p><a href="#fig-toydata">Figure&nbsp;1</a> displays the first five persistence diagrams of each sample. The reader can appreciate that the first two lines corresponding to the same trefoil geometry shows similar diagrams while the last line corresponding to a 2-arm archspiral shows a different kind of diagram.</p>
<div id="fig-toydata" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="toydata_preview.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: The first data point of each toy data set.</figcaption>
</figure>
</div>
<p>We can therefore use <code>inphr::two_sample_diagram_test()</code> to compare:</p>
<ul>
<li><code>trefoils1</code> and <code>trefoils2</code> with expected output that there is not enough statistical evidence to reject the hypothesis that the two samples come from the same distribution;</li>
<li><code>trefoils1</code> and <code>archspirals</code> with expected output that we can reject the hypothesis that the two samples come from the same distribution.</li>
</ul>
<p>The following code performs the test between the two trefoil samples using only the first five statistical units:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-2_296f7037c8c4cce86985f7139c4560d3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_seed</span>(<span class="dv">1234</span>, {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">two_sample_diagram_test</span>(trefoils1[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], trefoils2[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9702381</code></pre>
</div>
</div>
<p>As expected, the test is not able to reject the null hypothesis. By default, the function uses <code>B = 1000</code> permutations, which makes the p-value resolution of <span class="math inline">\(1/1001 \approx 9.99 \times 10^{-4}\)</span>. If we compare instead <code>trefoils1</code> against <code>archspirals</code>, again using only the first five statistical units, we get:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-3_b8b026c9560f2465af61d98cab413ab4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_seed</span>(<span class="dv">1234</span>, {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">two_sample_diagram_test</span>(trefoils1[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], archspirals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002308242</code></pre>
</div>
</div>
<p>As expected, the test does detect the difference despite the small sample size.</p>
</section>
</section>
<section id="sec-functions" class="level2">
<h2 class="anchored" data-anchor-id="sec-functions">Inference in the functional spaces</h2>
<section id="functional-representations-of-persistence-homology" class="level3">
<h3 class="anchored" data-anchor-id="functional-representations-of-persistence-homology">Functional representations of persistence homology</h3>
<p>The {inphr} package relies on the <a href="https://cran.r-project.org/package=TDAvec">{TDAvec}</a> package to compute functional representations of persistence diagrams. Currently, there are five truly functional representations (i.e.&nbsp;curves) of a given persisence diagram <span class="math inline">\(D = (b_i, d_i)_{i=1}^N\)</span> that {TDAvec} readily provides:</p>
<ul>
<li><p>the Betti curve <span class="citation" data-cites="chazal2021introduction">(<a href="#ref-chazal2021introduction" role="doc-biblioref">Chazal and Michel 2021</a>)</span>: <span class="math display">\[
\beta(t) = \sum_{i=1}^N \mathbb{1}_{[b_i, d_i)}(t).
\]</span></p></li>
<li><p>the Euler characteristic curve <span class="citation" data-cites="richardson2014efficient">(<a href="#ref-richardson2014efficient" role="doc-biblioref">Richardson and Werman 2014</a>)</span>: <span class="math display">\[
\chi(t) = \sum_{k=0}^d (-1)^k \beta_k(t),
\]</span> where <span class="math inline">\(\beta_0, \beta_1, \dots, \beta_d\)</span> are the Betti curves from the smaller persistence diagrams <span class="math inline">\(D_0, D_1, \dots, D_d\)</span> restricted to only features of homology dimensions <span class="math inline">\(0, 1, \dots, d\)</span> respectively.</p></li>
<li><p>the Normalized Life curve <span class="citation" data-cites="chung2022persistence">(<a href="#ref-chung2022persistence" role="doc-biblioref">Chung and Lawson 2022</a>)</span>: <span class="math display">\[
\mathrm{sl}(t) = \sum_{i=1}^N \frac{d_i - b_i}{L} \mathbb{1}_{[b_i, d_i)}(t), \quad \mbox{where } L = \sum_{i=1}^N (d_i - b_i).
\]</span></p></li>
<li><p>the Silhouette curve <span class="citation" data-cites="chazal2014stochastic">(<a href="#ref-chazal2014stochastic" role="doc-biblioref">Chazal et al. 2014</a>)</span>: <span class="math display">\[
\phi(t) = \frac{\sum_{i=1}^N (d_i - b_i) \Lambda_i(t)}{L}, \quad \mbox{where } \Lambda_i(t) = \begin{cases}
t - b_i &amp; \mbox{if } t \in \left[ b_i, \frac{b_i + d_i}{2} \right] \\
d_i - t &amp; \mbox{if } t \in \left( \frac{b_i + d_i}{2}, d_i \right] \\
0 &amp; \mbox{otherwise.}
\end{cases}
\]</span></p></li>
<li><p>the Entropy Summary curve <span class="citation" data-cites="atienza2020stability">(<a href="#ref-atienza2020stability" role="doc-biblioref">Atienza, González-Dı́az, and Soriano-Trigueros 2020</a>)</span>: <span class="math display">\[
S(t) = \sum_{i=1}^N \frac{d_i - b_i}{L} \log_2 \frac{d_i - b_i}{L} \mathbb{1}_{[b_i, d_i]}(t).
\]</span></p></li>
</ul>
<p><a href="#fig-betti">Figure&nbsp;2</a> displays, as an example, the Betti curve representations of the 24 diagrams in each of the three toy data sets.</p>
<div id="fig-betti" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="betti_curves.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: The Betti curves of all three toy data sets in {inphr}.</figcaption>
</figure>
</div>
<p><a href="#fig-betti">Figure&nbsp;2</a> shows a clear difference between trefoil and archspiral geometry but overlapped curves between the two trefoil samples as expected.</p>
</section>
<section id="interval-wise-testing-for-functional-data" class="level3">
<h3 class="anchored" data-anchor-id="interval-wise-testing-for-functional-data">Interval-wise testing for functional data</h3>
<p>The {inphr} package relies on the <a href="https://permaverse.github.io/fdatest/">{fdatest}</a> package which is also part of the permaverse to handle hypothesis testing on functional representations of persistence homology. Specifically, the {fdatest} package implements a method called <em>interval-wise testing</em> described in <span class="citation" data-cites="pini2017interval">Pini and Vantini (<a href="#ref-pini2017interval" role="doc-biblioref">2017</a>)</span> which effectively performs domain selection by identifying the portion(s) of the domain of definition of the functional representation where there are statistically significant differences between samples. In the future, the package will also integrate other such domain selection methods described in <span class="citation" data-cites="abramowicz2023domain">Abramowicz et al. (<a href="#ref-abramowicz2023domain" role="doc-biblioref">2023</a>)</span>.</p>
<p>When using functional representations, we must choose the homology dimension which we want to work on. In {inphr}, we perform inference in functional spaces with the <code>two_sample_functional_test()</code>. For example, the following code uses the Betti curves for dimension <span class="math inline">\(0\)</span> to compare the two trefoil samples:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_4ae392e1a17f5f400aa28ddb17fdf32c">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">two_sample_functional_test</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    trefoils1, trefoils2, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimension =</span> <span class="dv">0</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">representation =</span> <span class="st">"betti"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, the following code uses the Betti curves for dimension <span class="math inline">\(0\)</span> to compare the first trefoil sample and the archspiral sample:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-6_5d63dc73ec34d429bf70d86867f47509">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">two_sample_functional_test</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    trefoils1, archspirals, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimension =</span> <span class="dv">0</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">representation =</span> <span class="st">"betti"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output of the <code>two_sample_functional_test()</code> function is a list with entries:</p>
<ul>
<li><code>xfd</code>: a numeric matrix of shape <span class="math inline">\(N_1 \times (P - 1)\)</span> storing the chosen functional representation of the persistence diagrams in the 1st sample, where <span class="math inline">\(N_1\)</span> is the sample size and <span class="math inline">\(P\)</span> is the number of points on which the curves have been evaluated;</li>
<li><code>yfd</code>: a numeric matrix of shape <span class="math inline">\(N_2 \times (P - 1)\)</span> storing the chosen functional representation of the persistence diagrams in the 2st sample, where <span class="math inline">\(N_2\)</span> is the sample size and <span class="math inline">\(P\)</span> is the number of points on which the curves have been evaluated;</li>
<li><code>scale_seq</code>: a numeric vector of shape <span class="math inline">\(P\)</span> storing the grid on which the curves have been evaluated;</li>
<li><code>iwt</code>: an object of class ‘ITP2’ for which {fdatest} has dedicated <code>S3</code> implementations of methods such as <code>plot()</code>.</li>
</ul>
<p>Hence we can display the results of the inferential procedures with the following code:</p>
<div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out1<span class="sc">$</span>iwt, <span class="at">main =</span> <span class="st">"Trefoil 1 vs Trefoil 2"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out2<span class="sc">$</span>iwt, <span class="at">main =</span> <span class="st">"Trefoil vs 2-arm Archspiral"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-iwt" class="cell quarto-layout-panel" data-hash="index_cache/html/fig-iwt_788d748a96cc17ba4314b8bf8df08530">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-iwt-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-iwt-1.png" class="img-fluid figure-img" data-ref-parent="fig-iwt" width="672"></p>
<figcaption class="figure-caption">(a)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-iwt-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-iwt-2.png" class="img-fluid figure-img" data-ref-parent="fig-iwt" width="672"></p>
<figcaption class="figure-caption">(b)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-iwt-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-iwt-3.png" class="img-fluid figure-img" data-ref-parent="fig-iwt" width="672"></p>
<figcaption class="figure-caption">(c)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-iwt-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-iwt-4.png" class="img-fluid figure-img" data-ref-parent="fig-iwt" width="672"></p>
<figcaption class="figure-caption">(d)</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Visual representation of the Interval-Wise Testing procedure.</figcaption><p></p>
</figure>
</div>
</div>
<p><a href="#fig-iwt">Figure&nbsp;3</a> displays the results of the IWT procedure. We can see the portions where statistically significant differences have been detected highlighted by grey areas. The left column shows the curves of the two samples in two different colors while the right column shows the adjusted p-value functions which provide strong control of the familywise error rate.</p>
</section>
<section id="related-information-on-r-consortium-website" class="level3">
<h3 class="anchored" data-anchor-id="related-information-on-r-consortium-website">Related information on R Consortium website:</h3>
<ul>
<li><a href="https://r-consortium.org/posts/tidy-topological-machine-learning-with-tdavec-and-tdarec/index.html">Tidy topological machine learning with TDAvec and tdarec</a></li>
<li><a href="https://r-consortium.org/webinars/modular-interoperable-extensible-topological-data-analysis-in-r.html#agenda">Webinar: Modular, interoperable, and extensible topological data analysis in R</a></li>
</ul>
</section>
</section>
<section id="references" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-abramowicz2023domain" class="csl-entry" role="listitem">
Abramowicz, Konrad, Alessia Pini, Lina Schelin, Sara Sjöstedt de Luna, Aymeric Stamm, and Simone Vantini. 2023. <span>“Domain Selection and Familywise Error Rate for Functional Data: A Unified Framework.”</span> <em>Biometrics</em> 79 (2): 1119–32.
</div>
<div id="ref-atienza2020stability" class="csl-entry" role="listitem">
Atienza, Nieves, Rocı́o González-Dı́az, and Manuel Soriano-Trigueros. 2020. <span>“On the Stability of Persistent Entropy and New Summary Functions for Topological Data Analysis.”</span> <em>Pattern Recognition</em> 107: 107509.
</div>
<div id="ref-bubenik2023exact" class="csl-entry" role="listitem">
Bubenik, Peter, Jonathan Scott, and Donald Stanley. 2023. <span>“Exact Weights, Path Metrics, and Algebraic Wasserstein Distances.”</span> <em>Journal of Applied and Computational Topology</em> 7 (2): 185–219.
</div>
<div id="ref-chazal2014stochastic" class="csl-entry" role="listitem">
Chazal, Frédéric, Brittany Terese Fasy, Fabrizio Lecci, Alessandro Rinaldo, and Larry Wasserman. 2014. <span>“Stochastic Convergence of Persistence Landscapes and Silhouettes.”</span> In <em>Proceedings of the Thirtieth Annual Symposium on Computational Geometry</em>, 474–83.
</div>
<div id="ref-chazal2021introduction" class="csl-entry" role="listitem">
Chazal, Frédéric, and Bertrand Michel. 2021. <span>“An Introduction to Topological Data Analysis: Fundamental and Practical Aspects for Data Scientists.”</span> <em>Frontiers in Artificial Intelligence</em> 4: 667963.
</div>
<div id="ref-chung2022persistence" class="csl-entry" role="listitem">
Chung, Yu-Min, and Austin Lawson. 2022. <span>“Persistence Curves: A Canonical Framework for Summarizing Persistence Diagrams.”</span> <em>Advances in Computational Mathematics</em> 48 (1): 6.
</div>
<div id="ref-cohen2010lipschitz" class="csl-entry" role="listitem">
Cohen-Steiner, David, Herbert Edelsbrunner, John Harer, and Yuriy Mileyko. 2010. <span>“Lipschitz Functions Have l p-Stable Persistence.”</span> <em>Foundations of Computational Mathematics</em> 10 (2): 127–39.
</div>
<div id="ref-fasy2014confidence" class="csl-entry" role="listitem">
Fasy, Brittany Terese, Fabrizio Lecci, Alessandro Rinaldo, Larry Wasserman, Sivaraman Balakrishnan, and Aarti Singh. 2014. <span>“Confidence Sets for Persistence Diagrams.”</span>
</div>
<div id="ref-lovato2021multiscale" class="csl-entry" role="listitem">
Lovato, Ilenia, Alessia Pini, Aymeric Stamm, Maxime Taquet, and Simone Vantini. 2021. <span>“Multiscale Null Hypothesis Testing for Network-Valued Data: Analysis of Brain Networks of Patients with Autism.”</span> <em>Journal of the Royal Statistical Society Series C: Applied Statistics</em> 70 (2): 372–97.
</div>
<div id="ref-pesarin2010permutation" class="csl-entry" role="listitem">
Pesarin, Fortunato, and Luigi Salmaso. 2010. <em>Permutation Tests for Complex Data: Theory, Applications and Software</em>. John Wiley &amp; Sons.
</div>
<div id="ref-pini2017interval" class="csl-entry" role="listitem">
Pini, Alessia, and Simone Vantini. 2017. <span>“Interval-Wise Testing for Functional Data.”</span> <em>Journal of Nonparametric Statistics</em> 29 (2): 407–24.
</div>
<div id="ref-richardson2014efficient" class="csl-entry" role="listitem">
Richardson, Eitan, and Michael Werman. 2014. <span>“Efficient Classification Using the Euler Characteristic.”</span> <em>Pattern Recognition Letters</em> 49: 99–106.
</div>
<div id="ref-wadhwa2018tdastats" class="csl-entry" role="listitem">
Wadhwa, Raoul R, Drew FK Williamson, Andrew Dhawan, and Jacob G Scott. 2018. <span>“TDAstats: R Pipeline for Computing Persistent Homology in Topological Data Analysis.”</span> <em>Journal of Open Source Software</em> 3 (28): 860.
</div>
<div id="ref-wasserman2018topological" class="csl-entry" role="listitem">
Wasserman, Larry. 2018. <span>“Topological Data Analysis.”</span> <em>Annual Review of Statistics and Its Application</em> 5 (2018): 501–32.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">© 2026 R Consortium. R Consortium is a non-profit organization, and R Consortium™ is a trademark of R Consortium. All Rights Reserved. This website is built on Quarto, an open-source scientific and technical publishing system. Quarto uses R Markdown and knitr to execute R code.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>